# Mental Health Analysis

## Table of Contents

- [Overview](#overview)
- [Datasets](#datasets)
- [System Overview](#system-overview)
- [Getting Started](#getting-started)
- [Usage](#usage)
- [Configuration](#configuration)
- [Considerations](#considerations)
- [Acknowledgements](#acknowledgments)
- [Disclaimer](#disclaimer)
- [License](#license)

## Overview

This project presents an innovative text generation and analysis system built around the TinyLlama 1.1B model. Enhanced with Retrieval-Augmenation Language Model techniques, it aims to deliver contextually relevant and high-value responses based on user inputs. The system is particularly tailored for generating responses that simulate a therapeutic conversation style, leveraging anonymized AI therapist transcripts.

## Datasets

The datasets used for training encompass a variety of situations, however is not as comprehensive as a human therapist, the datasets instead used are:
1. **General Mental Health**\
Contains a transcript of broad range of mental health issues and coping mechanisms.
2. **Relationships and Communication**\
Contains a transcript of topics relating to interpersonal relationships, effective communication and confict resolution.
3. **Self Esteem and Confidence**\
Contains a transcript for building up self esteem and confidence in the real world.
4. **High Reflection**\
Contains classed responses of responses that are reflective instead of declarative

*Note: These datasets are subject to change based on the requirements and benefits of the model*


## System Overview

### Introduction

This document provides an overview of our advanced text generation and analysis system. The system is built around a TinyLlama 1.1B, enhanced with Retrieval-Enhanced Language Model (LLM) techniques. The primary application of this system is to generate contextually relevant and high-value responses based on user input, with a focus on continuous improvement through user feedback and reinforcement learning.

### System Components

#### 1. Base Model (TinyLlama 1.1B)

- The core of our system is the TinyLlama 1.1B model, known for its robust performance in generating human-like text. This model has been fine-tuned on a dataset of anonymized AI therapist transcripts to simulate therapeutic conversation styles.

#### 2. Retrieval-Augmented LLM

- We use an LLM to extract out the relevant topics which is passed to the main neural networ
- To enhance the relevance of the model's responses, we employ a Retrieval-Enhanced mechanism. This involves extracting key topics from user prompts using topic modeling techniques.
- These extracted topics are then used to retrieve contextually similar past responses or relevant information, which are fed into the base TinyLLama 1.1B model to inform its current response generation.

#### 3. Text Classifier

- Post-response generation, each response is fed into a text classifier. This classifier evaluates the response and categorizes it as either 'high value' or 'low value' based on its relevance, coherence, and utility.


#### 4. Topic Extraction

- Extracts the relevant topics from the user query, these relevant topics are then passed to the retrieval augmentation to improve the model.
- These topic extraction can be cached to prevent unnecessary running of the model


#### 5. Reinforcement Learning

- The text classifier plays a crucial role in the system's reinforcement learning mechanism. High-value responses are used to reinforce and fine-tune the model's training, encouraging the generation of similarly valuable responses in the future.

#### 6. User Feedback Loop

- Users have the option to provide feedback on each response generated by the system, classifying it as positive or negative.
- This feedback, along with the response, is stored and used for further reinforcement training of both the base model and the text classifier, ensuring continuous improvement of the system.


### Data Privacy and Ethics

Our system is designed with a strong emphasis on user privacy and ethical considerations. All user data is processed in a stateless manner; user inputs and feedback are used only for immediate response generation and model improvement without long-term storage.

### Future Enhancements

We are committed to the continuous improvement of our system. Future enhancements may include more advanced topic extraction methods, integration of additional context sources, and further refinement of our reinforcement learning algorithms.

## Getting Started

**Please refer to the individual readme's of the relevant models.**


## Usage

This model is **NOT** trained to imitate a therapist, it is simply trained to perform analysis on mental health and should not be used in replacement of a therapist. This is currently an api only availible to the CounselEase platform and it feeds the users thoughts into the api to get thoughtful insights into their mental states.

## Configuration

If you need to customize the mental health, you can modify the train.py script to change hyperparameters, and other settings that affect the quality and style of responses.

## Considerations

Due to the intimate nature upon which the model will be used for, its important that the model be free from protected class discrimation.\
For a model to be deployed:
1. It has to pass fairness benchmarks such as the [SBECC](https://arxiv.org/pdf/2112.14168.pdf) these are included in the testing
2. Pass manual human analysis, evaluated on a smaller group of data, based on specific guidelines. Outlined in the testing schema
3. Pass a seperate in house tool, designed to check if the response is of high quality feedback.


## Acknowledgments

This project was made possible using the TinyLLama 1.1B availible on [huggingface](https://huggingface.co/TinyLlama/TinyLlama-1.1B-Chat-v1.0?), Distilbert availible on [huggingface](https://huggingface.co/docs/transformers/model_doc/distilbert).


## Disclaimer

The information and responses generated by this system are based on artificial intelligence algorithms and are not provided by licensed therapists or medical professionals. This system is not intended to diagnose, treat, cure, or prevent any medical, psychological, or emotional conditions. Users should always seek the advice of qualified health providers with any questions regarding personal health or medical conditions. The use of this system does not replace professional medical advice, diagnosis, or treatment.



## License
*See LICENSE*

GNU GENERAL PUBLIC LICENSE
Version 3, 29 June 2007


This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.

